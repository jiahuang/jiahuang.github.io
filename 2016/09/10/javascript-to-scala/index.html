<!DOCTYPE html><html lang="en-us"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>A JavaScript developer's Scala cheatsheet | Jia Huang</title><meta name="description"><meta name="generator" content="Jia Huang"><meta name="author" content="Jia Huang"><meta name="keywords" content="jia huang, node.js, javascript, golang, scala, development"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=0"><link rel="stylesheet" type="text/css" href="/styles/screen.css"><link rel="apple-touch-icon" href="/images/svdb.png"><link rel="icon" type="image/png" href="/images/svdb.png"><meta name="msapplication-TileColor" content="#121315"><meta name="msapplication-TileImage" content="/images/svdb.png"></head><body itemscope itemtype="https://schema.org/WebPage"><header itemscope itemtype="https://schema.org/WPHeader"><img src="/images/profile.png"><h1><a href="/" alt="Jia Huang" title="Jia Huang" itemprop="headline">Jia Huang</a></h1><p itemprop="description"></p><nav itemscope itemtype="https://schema.org/SiteNavigationElement"><ul><li itemprop="name"><a href="/articles" alt="Writings" title="Writings" itemprop="url">Writings</a></li><li itemprop="name"><a href="/talks" alt="Talks" title="Talks" itemprop="url">Talks</a></li><li itemprop="name"><a href="/projects" alt="Projects" title="Projects" itemprop="url">Projects</a></li><li itemprop="name"><a href="/about" alt="About" title="About" itemprop="url">About</a></li><li><a href="https://github.com/jiahuang"> <img src="/images/github.png" style="height:25px;"></a><a href="https://twitter.com/jia"> <img src="/images/twitter.png" style="height:30px;"></a></li></ul></nav></header><main itemscope itemtype="https://schema.org/Blog"><article class="full"><h1 itemprop="headline">A JavaScript developer's Scala cheatsheet</h1><span class="post-meta">Published on<time itemprop="datePublished" datetime="2016-09-11T01:50:25.000Z"> Saturday, September 10th 2016 at 18:50</time><br>Last updated on<time itemprop="dateModified" datetime="2016-09-11T01:50:25.000Z"> Monday, September 19th 2016 at 0:26</time></span><p>I’ve been working in Scala for the past year. When I first started, I was pleasantly surprised by how similar it was to JavaScript. Scala is a functional language, supports streams, and has async programming through futures/promises. Conceptually, good JS code is good Scala code. But at the same time Scala is also an object oriented, typed language that runs on the JVM.</p>
<p>When writing JavaScript, it’s a breeze to start programming. However, I find myself having to exert a lot of mental energy closer to the end, when the program is coming together and I need to make sure the duck typing is handling all the edge cases. It’s the opposite with Scala where all my effort is frontloaded in making sure all the return types match. Once that happens, it’s almost trivial to write the logic.</p>
<p>Here’s an amalgamation of things I wish I saw when first learning Scala.</p>
<p><strong>Note: The examples are written with Scala 2.11.8 &amp; Akka version 2.4.10</strong></p>
<h3 id="Packaging-amp-Tools"><a href="#Packaging-amp-Tools" class="headerlink" title="Packaging &amp; Tools"></a>Packaging &amp; Tools</h3><p>The Scala equivalent of npm is <a href="http://www.scala-sbt.org/" target="_blank" rel="external">sbt</a>, the Simple Build Tool. Like npm, sbt handles packaging, dependencies, building, running, and testing.</p>
<p>Here are some commonly used sbt commands from the cli:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sbt run // runs the code</span><br><span class="line">sbt run -DKey1=1 -DKey2=2 // optional variables to use when starting to run the script</span><br><span class="line">sbt publish // publishes a package</span><br><span class="line">sbt publish-local // publishes a package locally. Useful <span class="keyword">if</span> you are developing multiple packages at once</span><br><span class="line">sbt <span class="built_in">test</span> // runs all tests</span><br><span class="line">sbt <span class="string">"test:test-only TestClassName"</span> // runs a specific <span class="built_in">test</span> class name</span><br></pre></td></tr></table></figure></p>
<p>sbt requires a <code>build.sbt</code> file in the main directory. It will look something like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">enablePlugins(JavaServerAppPackaging) <span class="comment">// see http://www.scala-sbt.org/sbt-native-packager/archetypes/java_server/</span></span><br><span class="line"></span><br><span class="line">name := <span class="string">"testproject"</span> <span class="comment">// name of your package</span></span><br><span class="line">organization := <span class="string">"com.mysite"</span> <span class="comment">// the package name will be com.mysite.testproject for namespacing</span></span><br><span class="line">version := <span class="string">"1.0"</span></span><br><span class="line">scalaVersion := <span class="string">"2.11.8"</span> <span class="comment">// version of scala this requires</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// list of package dependencies</span></span><br><span class="line">libraryDependencies ++= &#123;</span><br><span class="line">  val akkaV = <span class="string">"2.4.4"</span></span><br><span class="line">  val scalaTestV = <span class="string">"2.2.4"</span></span><br><span class="line">  Seq(</span><br><span class="line">    <span class="string">"com.typesafe.akka"</span> %% <span class="string">"akka-actor"</span> % akkaV,</span><br><span class="line">    <span class="string">"com.typesafe.akka"</span> %% <span class="string">"akka-stream"</span> % akkaV</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Basics"><a href="#Basics" class="headerlink" title="Basics"></a>Basics</h3><h4 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h4><p>Variable declaration is similar, with the exception of Scala having <code>var</code> and <code>val</code>. <code>val</code> is a <code>const</code> in JS. In Scala, it’s highly preferred to use <code>vals</code> when possible. Scala can be interpreted so to test these out just run <code>scala</code> from the cli.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> a = <span class="string">"a"</span></span><br><span class="line"><span class="comment">// however if you want to reassign a variable, it should be declared as a "var"</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">"b"</span></span><br><span class="line"><span class="comment">// array</span></span><br><span class="line"><span class="keyword">val</span> list = <span class="type">List</span>(item1, item2, item3)</span><br><span class="line"><span class="comment">// object</span></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClass</span>(<span class="params">a: <span class="type">Int</span>, b: <span class="type">Int</span>, c: <span class="type">Int</span></span>)</span></span><br><span class="line"><span class="type">TestClass</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h4><p>Functions cannot exist alone outside of classes, traits, or objects.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// def creates a method</span></span><br><span class="line"><span class="comment">// followed by add which is the method name</span></span><br><span class="line"><span class="comment">// aa takes in 2 parameters which are both of type Int</span></span><br><span class="line"><span class="comment">// and the Int after the colon is the return type of the method</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(a: <span class="type">Int</span>, b: <span class="type">Int</span>): <span class="type">Int</span> = &#123;</span><br><span class="line">  <span class="comment">// the result of the last line is returned by default</span></span><br><span class="line">  a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Methods can take in a callback:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// callback is a function that takes in an int and returns nothing</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sleep</span></span>(a: <span class="type">Int</span>, callback: (<span class="type">Int</span>) =&gt; <span class="type">Unit</span>) = &#123;</span><br><span class="line">  <span class="type">Thread</span>.sleep(a*<span class="number">1000</span>)</span><br><span class="line">  callback(a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>, (time) =&gt; &#123;println(<span class="string">s"slept for <span class="subst">$time</span> seconds"</span>)&#125;) <span class="comment">// prints "slept for 3"</span></span><br></pre></td></tr></table></figure></p>
<p>However Futures/Promises are generally preferred. This also avoids callback hell:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">doSomething</span></span>(a: <span class="type">String</span>): <span class="type">Future</span>[<span class="type">Int</span>] = &#123;</span><br><span class="line">  <span class="keyword">val</span> p = <span class="type">Promise</span>[<span class="type">Int</span>]</span><br><span class="line">  <span class="comment">// where someFunc is also a future that will take some time to complete</span></span><br><span class="line">  someFunc(a).onComplete &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Success</span>(res) =&gt; p.success(res)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Failure</span>(ex: <span class="type">Throwable</span>) =&gt; &#123; p.failure(ex) &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  p.future</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Functions can be <code>flatMap</code>ed to convert from one future type to another future type.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// some method definitions</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">someFunc</span></span>(a: <span class="type">Int</span>): <span class="type">Future</span>[<span class="type">String</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">someOtherFunc</span></span>(str: <span class="type">String</span>): <span class="type">Future</span>[<span class="type">Int</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">doSomething</span></span>(a: <span class="type">Int</span>): <span class="type">Future</span>[<span class="type">Int</span>] = &#123;</span><br><span class="line">  <span class="comment">// someFunc returns a String, but doSomething needs an int</span></span><br><span class="line">  <span class="comment">// someOtherFunc can return an int, so flatMap can change the</span></span><br><span class="line">  <span class="comment">// Future[String] to a Future[Int]</span></span><br><span class="line">  someFunc(a).flatMap&#123;res =&gt;</span><br><span class="line">    someOtherFunc(res)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Objects"><a href="#Objects" class="headerlink" title="Objects"></a>Objects</h4><p>In Scala there are classes, objects, and traits. Classes can be instantiated, objects and traits cannot. Traits can be mixed in to other classes or objects to extend a class/object’s functionality. In JS, this is all handled via the prototype chain.</p>
<p>There are case classes and regular classes. Case classes have tons of boilerplate that makes them easier to use along with enforced immutabilitly. Regular classes should be avoided unless there’s a bunch of mutable state in the class (which should be avoided anyway).</p>
<p>This would be the equivalent of instantiating a JS class:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClass</span>(<span class="params">a: <span class="type">Int</span>, b: <span class="type">Int</span></span>) <span class="title">//</span> <span class="title">takes</span> <span class="title">in</span> 2 <span class="title">parameters</span> <span class="title">which</span> <span class="title">are</span> <span class="title">all</span> <span class="title">integers</span>. <span class="title">these</span> 3 <span class="title">values</span> <span class="title">are</span> "<span class="title">vals</span>" <span class="title">by</span> <span class="title">default</span></span></span><br><span class="line"><span class="keyword">val</span> c = testClass(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">c.a <span class="comment">// is 1</span></span><br><span class="line">c.a = <span class="number">5</span> <span class="comment">// this will fail because you cannot reassign to a "val"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// you can have the case class take var instead if parameters will be mutable</span></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClass</span>(<span class="params">var a: <span class="type">Int</span>, var b: <span class="type">Int</span></span>)</span></span><br><span class="line"><span class="keyword">val</span> c = <span class="type">TestClass</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">c.a = <span class="number">5</span> <span class="comment">// this will work</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// case classes can also have methods</span></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClass</span>(<span class="params">a: <span class="type">Int</span>, b: <span class="type">Int</span></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// because this method does not need to take in a parameter</span></span><br><span class="line">  <span class="comment">// there is no need to have parens like isAGreater()</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">isAGreater</span></span>: <span class="type">Boolean</span> = &#123;</span><br><span class="line">    a &gt; b</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> c = <span class="type">TestClass</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">c.isAGreater <span class="comment">// returns false</span></span><br></pre></td></tr></table></figure></p>
<p>Static methods can be created by using a Scala Object:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Obj</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(a: <span class="type">Int</span>, b: <span class="type">Int</span>): <span class="type">Boolean</span> = &#123;</span><br><span class="line">    a + b</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">Obj</span>.add(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// returns 3</span></span><br></pre></td></tr></table></figure></p>
<p>Instead of the prototype chain, traits can be used to mix in methods<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> noise: <span class="type">String</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">makeNoise</span> </span>= &#123;</span><br><span class="line">    println(noise)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span>(<span class="params">noise: <span class="type">String</span></span>) <span class="keyword">extends</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="keyword">val</span> spot = <span class="type">Dog</span>(<span class="string">"ruff"</span>)</span><br><span class="line">spot.makeNoise</span><br></pre></td></tr></table></figure></p>
<h4 id="Array-functions"><a href="#Array-functions" class="headerlink" title="Array functions"></a>Array functions</h4><p>Array functions work similarly in JS &amp; Scala. Both languages have array functions that can be chained and take in lambda functions.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">list.map&#123;f =&gt; f+<span class="number">1</span>&#125;</span><br><span class="line">println(list) <span class="comment">// prints 2, 3, 4, 5</span></span><br><span class="line"><span class="comment">// a shorthand is to use _</span></span><br><span class="line">list.map&#123;_+<span class="number">1</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Streams"><a href="#Streams" class="headerlink" title="Streams"></a>Streams</h3><p>I heavily used the Akka library which includes <a href="http://doc.akka.io/docs/akka/2.4.10/scala/stream/index.html" target="_blank" rel="external">Akka-streams</a>. I found that Scala streams are way more complicated and harder to understand compared to JS streams. JS streams have an emitting function that can be listened to as chunks of data are read. It is then up to the listening function to handle each chunk of data correctly.</p>
<p>In Scala the read stream is a <code>source</code>. The source connects to a <code>sink</code>. In between the source and the sink can be several processing stages. Each of these processing stages can be abstracted out into a <code>flow</code>. Once the source and sink are connected the stream can be run.</p>
<p>Here’s an example that creates a source of numbers and filters out anything starting with 1:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> source: <span class="type">Source</span>[<span class="type">Int</span>, <span class="type">NotUsed</span>] = <span class="type">Source</span>(<span class="number">1</span> to <span class="number">100</span>)</span><br><span class="line">source</span><br><span class="line">  .filter&#123;i =&gt; i.toString.map(_.asDigit).head &gt; <span class="number">1</span>&#125;</span><br><span class="line">  .runForeach(println)</span><br><span class="line"></span><br><span class="line"><span class="comment">// can be rewritten to make the filter step a flow</span></span><br><span class="line"><span class="keyword">val</span> filterOnes = <span class="type">Flow</span>[<span class="type">Int</span>].filter&#123;i =&gt; i.toString.map(_.asDigit).head &gt; <span class="number">1</span>&#125;</span><br><span class="line"><span class="keyword">val</span> sink = <span class="type">Sink</span>.foreach[<span class="type">Int</span>](println)</span><br><span class="line"><span class="keyword">val</span> runnable = source via filterOnes to sink</span><br><span class="line">runnable.run()</span><br></pre></td></tr></table></figure></p>
<p>Flows are used for linear processing. There are also <a href=""><code>graphs</code></a> for branched processing.</p>
<h3 id="Actors"><a href="#Actors" class="headerlink" title="Actors"></a>Actors</h3><p>The Akka library also includes <a href="http://doc.akka.io/docs/akka/2.4.10/scala/actors.html" target="_blank" rel="external">Akka Actors</a>. Actors encapsulate state &amp; behavior and communicate to other actors via a messaging inbox which allow actors to act asynchronously. Messages in the inbox are handled in the order that they are received so the actor never gets overscheduled for tasks.</p>
<p>Here is a simple actor that logs what it receives:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> akka.actor.<span class="type">Actor</span></span><br><span class="line"><span class="keyword">import</span> akka.actor.<span class="type">Props</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// haveing a sealed trait for all messages of a particular type makes it easier to</span></span><br><span class="line"><span class="comment">// match on the message types later</span></span><br><span class="line"><span class="keyword">sealed</span> <span class="class"><span class="keyword">trait</span> <span class="title">ActorMessages</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Message</span>(<span class="params">msg: <span class="type">String</span>, importance: <span class="type">Int</span></span>) <span class="keyword">extends</span> <span class="title">ActorMessages</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Echo</span> <span class="keyword">extends</span> <span class="title">Actor</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">receive</span> </span>= &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Message</span>(msg: <span class="type">String</span>, importance: <span class="type">Int</span>) =&gt;</span><br><span class="line">      println(<span class="string">s"got <span class="subst">$msg</span>"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Actors can be created by other actors. Supervising actors can also handle error codes thrown by children through a <a href="http://doc.akka.io/docs/akka/current/scala/fault-tolerance.html" target="_blank" rel="external">supervisor strategy</a>.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sealed</span> <span class="class"><span class="keyword">trait</span> <span class="title">ActorMessages</span></span></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">CreateChild</span>(<span class="params">name: <span class="type">String</span></span>) <span class="keyword">extends</span> <span class="title">ActorMessages</span></span></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">DoSomething</span>(<span class="params">action: <span class="type">String</span></span>) <span class="keyword">extends</span> <span class="title">ActorMessages</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> <span class="keyword">extends</span> <span class="title">Actor</span> </span>&#123;</span><br><span class="line">  <span class="comment">// a supervisor strategy handles what happens when child actors fail</span></span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> supervisorStrategy = <span class="type">OneForOneStrategy</span>(maxNrOfRetries = <span class="number">3</span>, withinTimeRange = <span class="number">1</span> minute) &#123;</span><br><span class="line">    <span class="keyword">case</span> ex: <span class="type">Exception</span> =&gt;</span><br><span class="line">      println(<span class="string">"child actor failed"</span>, ex.printStackTrace)</span><br><span class="line">      <span class="type">Restart</span> <span class="comment">// this will restart the failed child actor</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">receive</span> </span>= &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">CreateChild</span>(name: <span class="type">String</span>) =&gt;</span><br><span class="line">      <span class="comment">// create a new child actor</span></span><br><span class="line">      <span class="keyword">val</span> child = context.actorOf(<span class="type">Props</span>(<span class="keyword">new</span> <span class="type">Child</span>(name)))</span><br><span class="line">      <span class="comment">// send a message to the created child</span></span><br><span class="line">      child ! <span class="type">DoSomething</span>(<span class="string">"throw error"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span>(<span class="params">name: <span class="type">String</span></span>) <span class="keyword">extends</span> <span class="title">Actor</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">receive</span> </span>= &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">DoSomething</span>(action: <span class="type">String</span>) =&gt;</span><br><span class="line">      action <span class="keyword">match</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"throw error"</span> =&gt; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">RuntimeException</span>(<span class="string">"child actor throwing error"</span>)</span><br><span class="line">        <span class="keyword">case</span> _ =&gt; println(<span class="string">"doing"</span>, action)</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Programming-in-Scala"><a href="#Programming-in-Scala" class="headerlink" title="Programming in Scala"></a>Programming in Scala</h3><p>Having to work with Scala in the past year has definitely made me a better programmer. It has made me formalize the way I approach a programming problem. The duck typing in JavaScript makes it all too tempting for me to bolt on features as I go, and end up with an unholy mess at the end. Scala also exposed me to other ways of looking at streams and concurrency, and gave me some new mental models for solving problems. </p>
</article></main></body></html>